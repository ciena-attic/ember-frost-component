language: node_js
node_js:
  - '5.0'
  - '5.6'

sudo: false

branches:
  only:
    - master

cache:
  directories:
    - node_modules

env:
  matrix:
    - EMBER_TRY_SCENARIO=default
    - EMBER_TRY_SCENARIO=ember-1-13
    - EMBER_TRY_SCENARIO=ember-release
    - EMBER_TRY_SCENARIO=ember-beta
    - EMBER_TRY_SCENARIO=ember-canary
  global:
    - CXX=g++-4.8
    - secure: "i+suBCdCDVDPSD83uCRZagABjWFhOMu3W5q/EFCEBJRTB/teOtDKntkLdZFpcDr3boy1kI8RNwkMQFMpma2lb99sKRo+DQ/nWPf2Aup9KmWas2dV7p7bHZg0W469pCkTciZYAPiVEvBbJqYCQ9W7I83p6ZVgauLYA3XwI64v19PafPIopVTq750WmhFFOdlU+Oi5anwIEoz/PHRqLeTP30E4I21whtFnARUbeNoawQHzgHGsjvnDrqkqVqHo1xOEAeSusIAwUDKaBrhBj8MdQddqoC7j5UDMz0SlgkRiNw34YsoaP81JTKyN0P6hPn7rmk/JN8DFM0hm+k5kteN9b7zNUwghkiX24Uu4JwB2LjQlNwYlX3aIcPCGU8E6ns9yIDbsjQ3ECxjM1GR2kCYs/akAcU1VE0N0eh0k32yM84Iu38FwWsWcEQJG4AEz2du7IbfRXMi/2RY6L6Z632q2fpKYi3w+vVel5m3/5Rs4MhronkETJssQyct6QV5X79D+SA9IEU4hLZCBeE7VwrnbFwnfhmjK9VY118pqDJcbvJVxfybn74hM12fTGFpbIZr9Uxp6wWFAdO0mr4Ap2KbdU/EzAS5NFL070/ei3O1FzYXoE4HyQ3cI29cTFb3TRQPVBOolx/abtqTqipsLIXyXEE8OKDSMESYfmylrqtDXgIg="

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8

matrix:
  fast_finish: true
  allow_failures:
    - env: EMBER_TRY_SCENARIO=ember-canary

before_install:
  - npm config set spin false
  - npm install -g pr-bumper
  - pr-bumper check

install:
  - npm install
  - bower install

script:
  - ember try $EMBER_TRY_SCENARIO test

before_deploy:
  - pr-bumper bump

deploy:
  provider: npm
  email: dahl.matthew@gmail.com
  skip_cleanup: true
  api_key:
    secure: X8R9zeYnrNGnylJ7erwIFnCcuk7QcdtxB+HgR8RL+KtxeDwBCprsAP3/MR7HARVTjIoOxdlNT4EQ4qOKLhOrzaaIivKw8WABRYRao17cDWJNUqo+QZ/bRdSUjhlu/B1iTWhiXLVZYYfkAcM6RHOvZq6n/7Mv3SQsvi/y8H8K6VcsC2RcxG+vX1Je1KT8OJubWz5LmGwIq7EbFMv0GQkhGVoOrSpWpZDIIlnSdvsx/OPW0oCWfmdQ8zOe75ipszrLGlZkGPd1SlnQ+mR3mipHQ41wg7Mq7NwY6VEIbTFHdvHDjgpdaH4rz3bzQmHZUeFe0ypccgcjSdawIWV22y2mmU7y3B6PddiiN6ori7tPcIpAe6fQMUXFojs8a9Xj252YDnf9sPL0gok9MhXEIwPGpnAnDn4he1vpniMQql7CcfisXpn/CGCbKJxgbpIxMDM6jTeFVMoyy+uBXZhL2py7CFoJSWKNSxW2pTXJvm4yCBHdmVwRbkJ0sGr+BPsww4idJ79F5gKA2tW/WY89dbAzp4k3QSoQ0azEDGW1J60kSqS1igKbDnjjG/7atUm7m9I36GSmEHyjqU218+/dsRIChZSvBCcGWgDoK8zh/4EoJ8oed2bryiglwHexBnwrOD4IPkDfCfw16LnnLj/w2kvi226DpVcoqRyUbfqqlZVdU9M=
  on:
    branch: master
    condition: "$EMBER_TRY_SCENARIO = 'default'"
    node: '5.6'
    tags: false
